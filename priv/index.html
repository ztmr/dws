<!DOCTYPE>
<html>
  <head>
    <title>Hello World!</title>
  </head>
  <body>
    <h1>Hello World!</h1>
    <form onSubmit="return false;">
      <input id="cmd" type="text" />
      <input id="req_btn" type="submit" value="OK" />
    </form>
    <pre id="log"></pre>

    <script type="text/javascript">
      var debug = function (msg) {
        var el = document.getElementById ('log');
        el.innerHTML = '[' + (new Date ()).toString () + ']: ' + msg + '<br />' + el.innerHTML;
      };
      var ws = new WebSocket ('ws://'+document.location.host+'/ws');
      ws.onopen = function (msg) {
        debug ('Connection open!');
        debug ('Handshake: ' + JSON.stringify (msg.data));
      };
      ws.onclose = function () { debug ('Connection close!'); };
      ws.onerror = function () { debug ('Connection error!'); };
      ws.onmessage = function (msg) {
        debug ('Message: ' + JSON.stringify (msg.data));
      };
      var btn = document.getElementById ('req_btn');
      var cmd = document.getElementById ('cmd');
      btn.onclick = function () { ws.send (cmd.value); cmd.value = ""; return false; };
    </script>
  </body>
</html>
